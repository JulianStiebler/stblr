![Header Image][header]
> First things first. This is a WIP rework of [StiebAPI][stiebapi]. This rework aims to be more efficient, with other data structures, better bootstrap-usage, more modern python etc. For a working project pls refer to StiebAPI.

## For Quick Access: External Library Documentation Links

> - [Flask-BCrypt][flaskbcrypt_docs]
> - [Flask-Login][flasklogin_docs]
> - [Flask-Mail][flaskmail_docs]
> - [Flask-Security][flasksecurity_docs]
> - [Flask-SQLAlchemy][sqlalchemy_docs]
> - [Flask-WTF][flaskwtf_docs]
> - [Flask-Limiter][flasklimiter_docs]
> - [Flask-Minify][flaskminify_docs]
> - [Flask-Jinja2][jinja2_docs]
> - etc..

## Security Measurements

> __Warning__ Always deactivate DEBUG under run.py!
# Security Measurements

- [ ] [Jinja2: Enable Autoescaping of all inputs](https://jinja.palletsprojects.com/en/3.1.x/api/)

```python
jinja_options = ImmutableDict(
 extensions=[
  'jinja2.ext.autoescape', 'jinja2.ext.with_' #Turn auto escaping on
 ])

app.jinja_env.autoescape = True 
```

- [X] [Flask-WTF: Enable csrf](https://flask-wtf.readthedocs.io/en/0.15.x/csrf/) - [What is CSRF?](https://www.synopsys.com/glossary/what-is-csrf.html)

```markdown
+ GET requests should be used to retrieve data from the web.
+ Sensitive routes that change information should be performed with POST requests in the proper form submission.
+ Requests that change the state should be mandated with a CSRF token generated by the server and sent to the userâ€™s browser.
+ The Origin and Referer header must be validated.
```

- [ ] [Care with file uploads!! DIRECTORY TRAVERSAL!](https://flask.palletsprojects.com/en/1.0.x/patterns/fileuploads/)

```diff
+ Always rename files coming from clients and assing random strings to it filenames, STRICT POLICY!!!!
```

- [ ] [Activate HTTPS and forbid use of HTTP](https://www.youtube.com/watch?v=Gdys9qPjuKs)
```markdown
+ Server must be configured correctly via NGINX, see [this tutorial.](http://nginx.org/en/docs/http/configuring_https_servers.html)
+ Can use LetsEncrypt via SSL, see [this tutorial.](https://pythonprogramming.net/ssl-https-letsencrypt-flask-tutorial/)
```
- [ ] [HTTP-Header good practice](https://stackoverflow.com/questions/60566143/what-is-the-best-practice-for-changing-headers-in-a-flask-request) - [HTTP-Headers Documentation](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers?retiredLocale=de) - [HTTP-Header list](https://en.wikipedia.org/wiki/List_of_HTTP_header_fields)

```diff
Good to use practice would be for example
+  Content-Security-Policy (CSP)
+  Strict-Transport-Security (HSTS)        
+  X-Permitted-Cross-Domain-Policies
+  X-Frame-Options
+  X-XSS-Protection
+  X-Content-Type-Options
+  X-Download-Options
+  Public-Key-Pins (HPKP)
```

- [ ] Care with syntax for SQL-Injection in SQLAlchemy Models! NEVER use raw SQL!! **That's BAD**!! Never combine the data string with the query string and always use SQLAlchemy [ORM-Model objects](https://docs.sqlalchemy.org/en/20/orm/) to describe a query.

```diff
- Bad way (SQL Injectable):
- Session.execute("select * form users where name = %s" % request.GET['name'])
+ Good way (Not SQL Injectable):
+ Session.execute(model.users.__table__.select().where(model.users.name == request.GET['name']))
```

## General Security Measurements

- [ ] Use [Flask-Security](https://pythonhosted.org/Flask-Security/) correctly!
- [ ] [Flask Documentation: Security Considerations](https://flask.palletsprojects.com/en/2.2.x/security/)
- [ ] Only run the Flask app in PRODUCTION behind a reverse proxy like nginx with HTTPS enabled!!!!!!!!!!!!!!!!!
- [ ] [Use OWASP ZAP](https://www.zaproxy.org/) (Penetration Testing) - [OWASP Top10 Vulnerabilities](https://owasp.org/Top10/)

## This is how the main-project looked like.
![Preview Image 1][previmg1]
![Preview Image 2][previmg2]
![Preview Image 3][previmg3]
![Preview Image 4][previmg4]

## This is how the main-project looked like
![Preview Image 1][previmg1]
![Preview Image 2][previmg2]
![Preview Image 3][previmg3]
![Preview Image 4][previmg4]

[//]: # (General Link References)
[header]: development/scrnshots/readme_header.png
[stiebapi]: https://github.com/JulianStiebler/PythonFlask_StiebAPI

[//]: # (Relative Project Link References)
[previmg1]: development/scrnshots/preview1.png
[previmg2]: development/scrnshots/preview2.png
[previmg3]: development/scrnshots/loginform_raw.png
[previmg4]: development/scrnshots/register_raw.png

[//]: # (General Documentation Link References)
[flask_docs_security]: https://flask.palletsprojects.com/en/2.2.x/security/
[jinja2_docs]: https://jinja.palletsprojects.com/en/3.1.x/api/
[flaskwtf_docs]: https://flask-wtf.readthedocs.io/en/0.15.x/csrf/
[sqlalchemy_docs]: https://docs.sqlalchemy.org/en/20/
[sqlalchemy_orm]: https://docs.sqlalchemy.org/en/20/orm/
[flasksecurity_docs]: https://pythonhosted.org/Flask-Security/
[http_headers_list]: https://en.wikipedia.org/wiki/List_of_HTTP_header_fields
[http_headers_docs]: https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers
[http_headers_howto]: https://stackoverflow.com/questions/60566143/what-is-the-best-practice-for-changing-headers-in-a-flask-request
[flasklogin_docs]: https://flask-login.readthedocs.io/en/latest/
[flasklimiter_docs]: https://flask-limiter.readthedocs.io/en/stable/
[flaskmigrate_docs]: https://flask-migrate.readthedocs.io/en/latest/
[flaskminify_docs]: https://pypi.org/project/Flask-Minify/
[flaskbcrypt_docs]: https://flask-bcrypt.readthedocs.io/en/1.0.1/
[flaskmail_docs]: https://pythonhosted.org/Flask-Mail/
[flasksecurity_docs]: https://pythonhosted.org/Flask-Security/

[//]: # (Vulnerabilities)
[csrf_explanation]: https://www.synopsys.com/glossary/what-is-csrf.html
[file_uploads]: https://flask.palletsprojects.com/en/1.0.x/patterns/fileuploads/
[top10_vulns]: https://owasp.org/Top10/

[//]: # (Shield Icons)
[shield_critical]: https://img.shields.io/badge/-CRITICAL-critical
[shield_info]: https://img.shields.io/badge/-INFO-informational
[shield_success]: https://img.shields.io/badge/-SUCCESS-success
[shield_important]: https://img.shields.io/badge/-IMPORTANT-yellow
[shield_general]: https://img.shields.io/badge/docs-general-green?logo=appveyor&style=plastic
[shields_dev]: https://img.shields.io/badge/docs-development-green?logo=appveyor&style=plastic
